---
title: "CovidPlots"
output: 
    github_document:
        toc: true
        toc_depth: 4
date: '`r format(Sys.time(), "%d %B %Y %I:%M %p %Z")`'
---


```{r, setup, include=FALSE}
knitr::opts_chunk$set(out.width = 4800,  fig.width = 12, fig.asp=0.62,  dev = 'svg') 
knitr::opts_chunk$set(echo = TRUE)
```




```{r, get_data, include=FALSE}
    source("nytimes_us_counties.r")
    ca <- getCountiesByChunk ('California', ISOdate(2020,3,1), 5,  countyPopulations)
    ny <- getCountiesByChunk ('New+York', ISOdate(2020,3,1), 5,  countyPopulations)
    mi <- getCountiesByChunk ('Michigan', ISOdate(2020,3,1), 5,  countyPopulations)
    selected <- getSelectedCounties(countyPopulations)
    subtext = "Data from NY Times via covid-19.datasettes.com"

```

## Covid in a Few Interesting Counties {.tabset} 

Covid case counts and death counts by county, based on daily data from NY Times via https://covid-19.datasettes.com

### Cases

```{r, selected_counties_cases, echo=FALSE, results='hide', message=FALSE,warning=FALSE}

    print(covidPlot(cases~date | county, data=selected, subtitle=subtext, group=state, main="Selected Counties"))
    
    print(covidPlot(100000*cases/county.population~date | county, data=selected, subtitle=subtext, group=state, main="Selected Counties",
          ylab="Cases per 100,000"))
    
    print(symmetricPlot(100000*case.slope/county.population~date | county, data=selected, group=selected$state, 
          subtitle = subtext, main="Selected Counties", 
          ylab="Slope (Cases/Day/100,000)",
          xlab="Date"))
    
    print(covidPlot(cases~date, data=selected, group=county, subtitle=subtext, main="Selected Counties",
        auto.key= list(cex=0.6, columns=3),
        par.settings= list(superpose.symbol=list(pch=1:25)) ))
    
    

```
        
### Deaths

```{r, selected_counties_deaths, echo=FALSE, results='hide', message=FALSE,warning=FALSE}    
    
    print(covidPlot(deaths~date | county, data=selected, subtitle=subtext, group=state, main="Selected Counties"))
    
    print(covidPlot(100000*deaths/county.population~date | county, data=selected, group=state, 
                            subtitle=subtext, ylab="Deaths per 100,000", main="Selected Counties"))

    
    print(symmetricPlot(100000*death.slope/county.population~date | county, data=selected, group=selected$state, 
        subtitle = subtext, main="Selected Counties", 
        ylab="Slope (Deaths/Day/100,000)",
        xlab="Date"))

    print(covidPlot(deaths~date, data=selected, group=county, subtitle=subtext, main="Selected Counties",
                            auto.key= list(cex=0.6, columns=3),
                            par.settings= list(superpose.symbol=list(pch=1:25)) ))
    

```

## Covid in All California Counties {.tabset}
Covid case counts and death counts by county, based on daily data from NY Times via https://covid-19.datasettes.com
```{r, california_counties, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    print(covidPlot(cases~date | county, data=ca, group=county, subtitle=subtext, main="California Counties"))
    print(covidPlot(deaths~date | county, data=ca, group=county, subtitle=subtext, main="California Counties"))
    print(covidPlot(100000*deaths/county.population~date | county, data=ca, group=county, subtitle=subtext, 
                            ylab="Deaths per 100,000", main="California Counties"))
    
```

## Covid in All New York Counties {.tabset}
Covid case counts and death counts by county, based on daily data from NY Times via https://covid-19.datasettes.com
```{r, new_york_counties, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    print(covidPlot(cases~date | county, data=ny, group=county, subtitle=subtext, main="New York Counties"))
    print(covidPlot(deaths~date | county, data=ny, group=county, subtitle=subtext, main="New York Counties"))
    print(covidPlot(100000*deaths/county.population~date | county, data=ny, group=county, subtitle=subtext, 
                            ylab="Deaths per 100,000", main="New York Counties"))
    
```

## Covid in All Michigan Counties {.tabset}
Covid case counts and death counts by county, based on daily data from NY Times via https://covid-19.datasettes.com
```{r, michigan_counties, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    print(covidPlot(cases~date | county, data=mi, group=county, subtitle=subtext, main="Michigan Counties"))
    print(covidPlot(deaths~date | county, data=mi, group=county, subtitle=subtext, main="Michigan Counties"))
    print(covidPlot(100000*deaths/county.population~date | county, data=mi, group=county, subtitle=subtext, 
                            ylab="Deaths per 100,000", main="Michigan Counties"))
    
```


## Covid in US States {.tabset}
Covid positive tests, deaths, and hospitalizations by state from covidtracking.com https://covidtracking.com

### Hospitalizations

```{r,  state_hospital, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    source("covidtracking_us_states.r")
  print (p_hosp)
  print(p_hospPer)
  print(p_deltaHospPer)
```

### Positives

```{r,  state_positves, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    source("covidtracking_us_states.r")
  print(p_positives)
  print(p_positivesPer)
  print (p_deltaPositivesPer)
```

### Deaths

```{r,  state_deaths, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    source("covidtracking_us_states.r")
  print(p_deaths)
  print (p_deathsPer)
  print(p_deltaDeathsPer)
    
```


## Covid in China {.tabset}

Covid data from Johns Hopkins CSSE via https://covid-19.datasettes.com
```{r,  china, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
    source("covid_international.r")
    print(p_china)
    print(p_china_deaths)
```


